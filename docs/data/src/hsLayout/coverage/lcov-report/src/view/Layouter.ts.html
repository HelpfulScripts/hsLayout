<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for src/view/Layouter.ts</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">hsLayout: All files</a> / <a href="index.html">src/view</a> Layouter.ts
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">92% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>23/25</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">75% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>9/12</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>6/6</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">95.24% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>20/21</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">26x</span>
<span class="cline-any cline-yes">26x</span>
<span class="cline-any cline-yes">14x</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">72x</span>
<span class="cline-any cline-yes">72x</span>
<span class="cline-any cline-yes">182x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">170x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">72x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
Layouter.ts provides basic mechanisms for laying out a view container. 
Subclasses of `Layouter` should
- implement the {@link Layouter.Layouter.getStyles getStyles} method.
- register the subclass and configuration keyword with the static 
   {@link Layouter.Layouter.register register} method.
*/
&nbsp;
/** */
import { Vnode}         from 'mithril';
import { LayoutToken }  from './Tokens';
import { Layout }       from './Layout';
import { px, pc, FILL } from './Tokens';
&nbsp;
/**
Abstract base class for creating layout style implementations.
Subclasses should implement `getStyles`. In addition, subclasses need to be registered with the 
static `Layouter.register` method.
### Example
&lt;code&gt;
class MyLayouter extends Layouter {
    cssClass = '.my-css-class';
    constructor(public areaDesc:LayoutToken[]) { 
        super(areaDesc); 
    }
    
    protected getStyles(components:Array&lt;Vnode|Layout&gt;):string {
        components.map((c:Layout|Vnode, i:number) =&gt; {
            c.style = `width:auto; height:auto;
        });   
        return this.cssClass;
   }
}
&nbsp;
Layouter.register('MyLayouter', MyLayouter);
&lt;/code&gt;
 */
export abstract class Layouter {
    /**
     * statis list of available styles. The key for each entry is the keyword that triggers the style,
     * and the value is a constructor for that style
     */
    static layoutStyles:{string?: Layouter} = {};
&nbsp;
    /**
     * Translates `string` params to {@link hsLayout:Tokens.LayoutToken LayoutTokens}.
     * The `params` are expected to either
     * - end in 'px'
     * - end in '%'
     * - be equal to 'fill' (case insensitive)
     * @param params an Array of strings that will be converted to an array of LayourTokens.
     * 
     */
    private static translate(params:Array&lt;string|any&gt;):Array&lt;LayoutToken&gt; {
        <span class="missing-if-branch" title="if path not taken" >I</span>if (params.length === 0) { <span class="cstat-no" title="statement not covered" >params.push(''); </span>}   //  [] --&gt; ['']
        return params.map((param:string|any) =&gt; {
            <span class="missing-if-branch" title="else path not taken" >E</span>if (typeof param === 'string') {
                if (param.endsWith('px')) { return px(parseInt(param)); }
                if (param.endsWith('%')) { return pc(parseInt(param)); }
                <span class="missing-if-branch" title="else path not taken" >E</span>if (param.toLowerCase()==='fill') { return FILL;}
            } else {
<span class="cstat-no" title="statement not covered" >                return param;</span>
            }
        });
    }
&nbsp;
    /**
     * Register a new Layouter style with corresponding configuration keyword.
     * Example:```
     * class ColumnsLayout extends Layouter {...}
     * Layouter.register('Column', Columns);
     * ```
     * @param keyword the keyword used in the attributes to `this.layout`
     * @param style the `Layouter` implementation to instantiate when encountering `keyword` 
     */
    public static register(keyword:string, style:typeof Layouter) {
//        console.log(`registering ${keyword} layout`);
        Layouter.layoutStyles[keyword] = style;
    }
&nbsp;
    /**
     * Lays out the `components` according to the configuration in `attrs`.
     * The method will search for a registered layout key in `attrs`, then construct the `Layouter` associated with the key
     * with the parameters for the key, and call the `getStyles` method on the style with the provided `components`.
     * @param attrs an object literal, typically provided as middle attributes object in the m(css, {}, '') call.
     * @param components 
     * @return returns the css class that the `getStyles` function returns.
     */
    public static createLayout(attrs:any, components:Array&lt;Vnode&gt;):string {
        let css = '';
        Object.keys(Layouter.layoutStyles).some(key =&gt; { // executes the first match key in attrs.
            if (attrs[key]) { 
                css = new Layouter.layoutStyles[key](Layouter.translate(attrs[key])).getStyles(components); 
                attrs[key] = undefined;
                return true;
            }
            return false;
        });
        return css;
    }
&nbsp;
&nbsp;
    spacing = 0;   
    
    /**
     * Layouter Constructor, will be called by the static `createLayout` method when creating the layout on a {@link hsLayout:Layout.Layout `Layout`}.
     * The `areaDesc` parameter is expected to be of the form {&lt;keyword&gt;: {@link hsLayout:Tokens.LayoutToken `LayoutToken`}[]}} 
     * and will be passed through form the `Layout` requesting the layout.
     * @param areaDesc 
     */
    constructor(public areaDesc:LayoutToken[]) {};
&nbsp;
    /**
     * Calculates the style attributes required for each component in `Components`.
     * These attributes are saved in a `style` field on the component itself. 
     * During rendering these `style` attributes are copied to the `node.attrs.styles` field.
     * ### Example
    &lt;code&gt;protected getStyles(components:Array&lt;Vnode|Layout&gt;):string {
        components.map((c:Layout|Vnode, i:number) =&gt; {
            c.style = `width:auto; height:auto;
        });   
        return this.cssClass;
    }
    &lt;/code&gt;
     * @param components 
     */
    protected abstract getStyles(components:Array&lt;Vnode|Layout&gt;):string;
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->

</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
